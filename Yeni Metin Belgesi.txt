export default function Data() {
    // const isim = document.getElementById('isim');
    // const veriCekButton = document.getElementById('veriCekButton');
    // const postBTN = document.getElementById('post');
    // const veriListesi = document.getElementById('veriListesi');

    const veriCek = async () => {
        try {
            const response = await fetch('/veri');
            const data = await response.json();
            
            // console.log(data);
            veriListesi.innerHTML = ''; // Önceki içeriği temizle

            data.map((elem) => {
                const p = document.createElement('p');
                const del = document.createElement('button');
                p.innerText = elem.body;
                del.innerText = 'delete';
                const uniqueClass = 'del-' + Math.random().toString(36).substr(2, 9);
                del.classList.add(uniqueClass);
                veriListesi.appendChild(p);
                veriListesi.appendChild(del);
                const trashcan = document.querySelector('.' + uniqueClass);

                trashcan.addEventListener('click', (e) => {
                    const endpoint = `/veri/${elem._id}`;

                    fetch(endpoint, {
                        method: 'DELETE',
                    })
                    .then(response => response.json())
                    .then(data => window.location.href = '/')
                    .catch(err => console.log(err));
                });

            });
        } catch (error) {
            console.log(error);
        }


    };

   
    veriCekButton.addEventListener('click', async () => {
        await veriCek();

    });

    postBTN.addEventListener('click', async() => {
        const data = {
            isim : isim.value,
        };
        const response = await fetch('/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json' /* içerik tipi json*/
            },
            body: JSON.stringify(data)
        });
        console.log(data);
        // veriCekButton.click();
    }); 




    return(
        <div>
            <input type="text" id="isim" class="yazi" placeholder="Lütfen Birşeyler yaz"></input>
            <button id="veriCekButton" class="buton">VeriCek</button>
            <button id="post">post</button>            
            <div id="veriListesi"></div>
        </div>
    )
}